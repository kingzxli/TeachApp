<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.song.mapper.CommentMapper">

	<insert id="add" parameterType="Comment">
		insert into comment (tid,pid,content,nums,image,types,ordernum,pimage,pname,addtime)
		 values (#{tid},#{pid},#{content},#{nums},#{image},#{types},#{ordernum},#{pimage},#{pname},#{addtime})
	</insert>
	
	<select id="select" parameterType="int" resultType="Comment">
		select * from comment where tid=#{tid}
	</select>
	
	<select id="selectByOrder" parameterType="Comment" resultType="Comment">
		select c.*,o.body from comment c,orders o where c.tid=#{tid} and c.ordernum = o.ordernum and c.ordernum = #{ordernum}
	</select>
	
	
	<resultMap type="Comment" id="commentMap">
		<id column="id" property="id"/>
		<result column="content" property="content"/>
		<result column="nums" property="nums"/>
		<result column="addtime" property="addtime"/>
		<association property="order" javaType="Order">
			<id column="id" property="id"/>
			<result column="image" property="image"/>
			<result column="name" property="name"/>
			<result column="body" property="body"/>
			<result column="totalnum" property="totalnum"/>
			<result column="num" property="num"/>
			<result column="types" property="types"/>
			<result column="price" property="price"/>
		</association>
	</resultMap>
	<select id="selectByOrdernum" parameterType="String" resultMap="commentMap">
		select * from orders o,comment c where o.comment='æ˜¯' and o.ordernum = c.ordernum and o.ordernum = #{ordernum}
	</select>

</mapper>